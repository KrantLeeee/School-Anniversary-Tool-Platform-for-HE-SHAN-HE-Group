# OAuth 授权码授权

> 来源: https://www.coze.cn/open/docs/developer_guides/oauth_code

- ​ 配置 ​ 说明 ​ 应用类型 ​ 应用的类型，此处设置为 普通 。 ​ 客户端类型 ​ 客户端类型，此处设置为 Web 后端应用 。 ​ 应用名称 ​ 应用的名称，在扣子编程中全局唯一。 ​ 描述 ​ 应用的基本描述信息。 ​ ​

| 配置​ | 说明​ |
| 应用类型​ | 应用的类型，此处设置为普通。​ |
| 客户端类型​ | 客户端类型，此处设置为Web 后端应用。​ |
| 应用名称​ | 应用的名称，在扣子编程中全局唯一。​ |
| 描述​ | 应用的基本描述信息。​ |


- ​ 配置 ​ 说明 ​ 权限 ​ 应用程序调用扣子 API 时需要的权限范围。 ​ 说明 此处配置旨在于划定应用的权限范围，并未完成授权操作。创建 Oauth 应用后还需要参考后续操作完成授权。 ​ ​ 重定向 URL ​ 重定向的 URL 地址。用户完成授权后，扣子编程的授权服务器将通过重定向 URL 返回授权相关的凭据。最多可添加 3 个不同的 URL 地址。 ​ 重定向 URL 仅支持 HTTP 和 HTTPs。为了保证数据传输安全，请勿在生产环境使用HTTP 协议地址。 ​ 对于测试场景，您可以指定引用本地机器的 URL，例如 http://localhost:8080 。 ​ 客户端 ID 和客户端密钥 ​ ​ 客户端 ID 和客户端密钥均由扣子编程自动生成并配置。单击生成客户端密钥，并复制系统自动生成的客户端密钥。 ​ 客户端 ID：即 client id，是应用程序的公共标识符。 ​ 客户端密钥：即 client secret，仅应用程序和授权服务器有权访问的密钥。用于获取已登录用户的访问令牌。 ​ 说明 此客户端密钥仅显示一次。请将其保存到安全且易于访问的地方。不要与他人分享，或在其他环境中暴露。 ​ 支持生成多个客户端密钥，当您发现密钥泄露时，可以通过此方法进行密钥轮转。 ​ 扣子编程在任何时候都不会存储您的客户端密钥，扣子服务端仅存储符合行业规范的密钥摘要值。 ​ ​ ​

| 配置​ | 说明​ |
| 权限​ | 应用程序调用扣子 API 时需要的权限范围。​说明此处配置旨在于划定应用的权限范围，并未完成授权操作。创建 Oauth 应用后还需要参考后续操作完成授权。​​ |
| 重定向 URL​ | 重定向的 URL 地址。用户完成授权后，扣子编程的授权服务器将通过重定向 URL 返回授权相关的凭据。最多可添加 3 个不同的 URL 地址。​重定向 URL 仅支持 HTTP 和 HTTPs。为了保证数据传输安全，请勿在生产环境使用HTTP 协议地址。​对于测试场景，您可以指定引用本地机器的 URL，例如http://localhost:8080。​ |
| 客户端 ID 和客户端密钥​​ | 客户端 ID 和客户端密钥均由扣子编程自动生成并配置。单击生成客户端密钥，并复制系统自动生成的客户端密钥。​客户端 ID：即 client id，是应用程序的公共标识符。​客户端密钥：即 client secret，仅应用程序和授权服务器有权访问的密钥。用于获取已登录用户的访问令牌。​说明此客户端密钥仅显示一次。请将其保存到安全且易于访问的地方。不要与他人分享，或在其他环境中暴露。​支持生成多个客户端密钥，当您发现密钥泄露时，可以通过此方法进行密钥轮转。​扣子编程在任何时候都不会存储您的客户端密钥，扣子服务端仅存储符合行业规范的密钥摘要值。​​ |

- 重定向 URL 仅支持 HTTP 和 HTTPs。为了保证数据传输安全，请勿在生产环境使用HTTP 协议地址。 ​

- 对于测试场景，您可以指定引用本地机器的 URL，例如 http://localhost:8080 。 ​

- 客户端 ID：即 client id，是应用程序的公共标识符。 ​

- 客户端密钥：即 client secret，仅应用程序和授权服务器有权访问的密钥。用于获取已登录用户的访问令牌。 ​

- 此客户端密钥仅显示一次。请将其保存到安全且易于访问的地方。不要与他人分享，或在其他环境中暴露。 ​

- 支持生成多个客户端密钥，当您发现密钥泄露时，可以通过此方法进行密钥轮转。 ​

- 扣子编程在任何时候都不会存储您的客户端密钥，扣子服务端仅存储符合行业规范的密钥摘要值。 ​




- 应用程序通过302重定向方式发起 ​ 获取授权页面 URL API 请求。 ​

- 请求中携带 OAuth 应用的客户端 ID 和客户端密钥 、重定向 URL 等信息。请求示例如下： ​

- ​

- Response Header 中的 location 字段中为跳转链接。例如 https://www.coze.cn/oauth/consent?authorize_key=JacVeqTW93ps5m5N9n349bEBgIsWrnNp 。浏览器跳转到此 URL，引导用户完成扣子账号授权。授权页面示例如下： ​

- ​ ​ ​ ​ ​

- ​


- 从重定向的 URL 地址中获取 code，例如本示例中 code 为 code_WZmPRDcjJhfwHD**** 。 ​

- ​


- 应用程序向扣子服务端发起 ​ 获取 OAuth Access Token 请求，请求中携带 code，扣子服务端会在 API 的响应中返回 access_token 和 refresh_token。其中： ​

- access_token 即访问令牌，用于发起扣子 API 请求时鉴权，有效期为 15 分钟。 ​

- refresh_token 用于刷新 access_token，有效期为 30 天。refresh_token 到期前可以多次调用 ​ 刷新 OAuth Access Token 接口获取新的 refresh_token 和 access_token。 ​

- 接口示例如下： ​

- ​